#
#  Makefile for FastCGI examples directory
#
#  $Id: Makefile.in,v 1.10 2001/09/01 01:06:58 robs Exp $
#

SHELL = @SHELL@
O     = @OBJEXT@
L     = @L@
CC    = @CC@
HAVE_LIBPTHREAD  = @HAVE_LIBPTHREAD@
EXEEXT  = @EXEEXT@

INCLUDEDIR  = ../include
CFLAGS  = @CCDEFS@ -I$(INCLUDEDIR)
LIBS    = @LIBS@
RANLIB  = @RANLIB@

LIBDIR      = ../libfcgi
LIBFCGI     = $(LIBDIR)/libfcgi.${L}

INCLUDES    = $(INCLUDEDIR)/fastcgi.h    \
              $(INCLUDEDIR)/fcgiapp.h    \
              $(INCLUDEDIR)/fcgimisc.h   \
              $(INCLUDEDIR)/fcgi_stdio.h

TARGETS     = authorizer \
              echo \
              echo-x\
              log-dump

if test "$(HAVE_LIBPTHREAD)"; then TARGETS="$TARGETS threaded" fi

all: $(TARGETS)

threaded: threaded.c $(INCLUDES) $(LIBFCGI)
	$(CC) $(CFLAGS) -D_REENTRANT threaded.c -o threaded $(LIBFCGI) $(LIBS) -lpthread

authorizer: authorizer.c $(INCLUDES) $(LIBFCGI)
	$(CC) $(CFLAGS) authorizer.c -o authorizer $(LIBFCGI) $(LIBS)

echo: echo.c $(INCLUDES) $(LIBFCGI)
	$(CC) $(CFLAGS) echo.c -o echo $(LIBFCGI) $(LIBS)

echo-x: echo-x.c $(INCLUDES) $(LIBFCGI)
	$(CC) $(CFLAGS) echo-x.c -o echo-x $(LIBFCGI) $(LIBS)

log-dump: log-dump.c $(INCLUDES) $(LIBFCGI)
	$(CC) $(CFLAGS) log-dump.c -o log-dump $(LIBFCGI) $(LIBS)

clean:
	rm -f *.${L} *.${O} core.* errs *~ \#* TAGS *.E a.out ${TARGETS:=$(EXEEXT)}

# ----------------------------------------------------------------------------
